{"version":3,"sources":["../src/Keyboard.js"],"names":["Keyboard","state","currentLayout","showSymbols","uppercase","isUppercase","handleLanguageClick","setState","props","layouts","length","handleShiftClick","handleSymbolsClick","handleLetterButtonClick","key","inputNode","value","selectionStart","selectionEnd","nextValue","substring","onClick","setTimeout","focus","setSelectionRange","dispatchEvent","Event","handleBackspaceClick","nextSelectionPosition","isFirstLetterUppercase","type","dataset","keysSet","layout","map","keyRow","toUpperCase","symbolsKeyValue","backSpace","shift","leftButtons","rightButtons","space","keys","getKeys","numbers","getSymbolsKeyValue","button","propTypes","arrayOf","node","any","isRequired","func","bool","shape","string","object","defaultProps"],"mappings":"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","file":"Keyboard.js","sourcesContent":["import React, {PureComponent, PropTypes} from 'react';\nimport KeyboardButton from './KeyboardButton';\n\nimport LatinLayout from './layouts/LatinLayout';\nimport CyrillicLayout from './layouts/CyrillicLayout';\nimport SymbolsLayout from './layouts/SymbolsLayout';\n\nimport BackspaceIcon from './icons/BackspaceIcon';\nimport LanguageIcon from './icons/LanguageIcon';\nimport ShiftIcon from './icons/ShiftIcon';\n\nexport default class Keyboard extends PureComponent {\n\tstatic propTypes = {\n\t\tleftButtons: PropTypes.arrayOf(PropTypes.node),\n\t\trightButtons: PropTypes.arrayOf(PropTypes.node),\n\t\tinputNode: PropTypes.any.isRequired,\n\t\tonClick: PropTypes.func,\n\t\tisFirstLetterUppercase: PropTypes.bool,\n\t\tlayouts: PropTypes.arrayOf(PropTypes.shape({\n\t\t\tsymbolsKeyValue: PropTypes.string,\n\t\t\tlayout: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n\t\t})),\n\t\tbackSpace: PropTypes.object,\n\t\tshift: PropTypes.object,\n\t\tspace: PropTypes.string\n\t};\n\n\tstatic defaultProps = {\n\t\tleftButtons: [],\n\t\trightButtons: [],\n\t\tisFirstLetterUppercase: false,\n\t\tlayouts: [CyrillicLayout, LatinLayout],\n\t\tbackSpace: null,\n\t\tshift: null,\n\t\tspace: ' '\n\t};\n\n\tstate = {\n\t\tcurrentLayout: 0,\n\t\tshowSymbols: false,\n\t\tuppercase: this.isUppercase(),\n\t}\n\n\thandleLanguageClick = () =>\n\t\tthis.setState({\n\t\t\tcurrentLayout: (this.state.currentLayout + 1) % this.props.layouts.length,\n\t\t\tshowSymbols: false,\n\t\t})\n\n\thandleShiftClick = () =>\n\t\tthis.setState({uppercase: !this.state.uppercase})\n\n\thandleSymbolsClick = () =>\n\t\tthis.setState({showSymbols: !this.state.showSymbols})\n\n\thandleLetterButtonClick = (key) => {\n\t\tconst {inputNode} = this.props;\n\t\tconst {value, selectionStart, selectionEnd} = inputNode;\n\t\tconst nextValue = value.substring(0, selectionStart) + key + value.substring(selectionEnd);\n\n\t\tinputNode.value = nextValue;\n\t\tif (this.props.onClick) {\n\t\t\tthis.props.onClick(nextValue);\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tinputNode.focus();\n\t\t\tinputNode.setSelectionRange(selectionStart + 1, selectionStart + 1);\n\t\t}, 0);\n\t\tthis.setState({uppercase: this.isUppercase()});\n\t\tinputNode.dispatchEvent(new Event('input'));\n\t}\n\n\thandleBackspaceClick = () => {\n\t\tconst {inputNode} = this.props;\n\t\tconst {value, selectionStart, selectionEnd} = inputNode;\n\t\tlet nextValue;\n\t\tlet nextSelectionPosition;\n\t\tif (selectionStart === selectionEnd) {\n\t\t\tnextValue = value.substring(0, selectionStart - 1) + value.substring(selectionEnd);\n\t\t\tnextSelectionPosition = selectionStart - 1;\n\t\t} else {\n\t\t\tnextValue = value.substring(0, selectionStart) + value.substring(selectionEnd);\n\t\t\tnextSelectionPosition = selectionStart;\n\t\t}\n\t\tnextSelectionPosition = (nextSelectionPosition > 0) ? nextSelectionPosition : 0;\n\n\t\tinputNode.value = nextValue;\n\t\tif (this.props.onClick) {\n\t\t\tthis.props.onClick(nextValue);\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tinputNode.focus();\n\t\t\tinputNode.setSelectionRange(nextSelectionPosition, nextSelectionPosition);\n\t\t}, 0);\n\t\tthis.setState({uppercase: this.isUppercase()});\n\t\tinputNode.dispatchEvent(new Event('input'));\n\t}\n\n\tisUppercase() {\n\t\tconst {inputNode, isFirstLetterUppercase} = this.props;\n\t\treturn inputNode.type !== 'password' &&\n\t\t\tinputNode.dataset.type !== 'email' &&\n\t\t\t!inputNode.value.length && isFirstLetterUppercase;\n\t}\n\n\tgetKeys() {\n\t\tlet keysSet;\n\t\tif (this.state.showSymbols) {\n\t\t\tkeysSet = SymbolsLayout.layout;\n\t\t} else {\n\t\t\tkeysSet = this.props.layouts[this.state.currentLayout].layout;\n\t\t}\n\n\t\treturn this.state.uppercase ?\n\t\t\tkeysSet.map(keyRow => keyRow.map(key => key.toUpperCase()))\n\t\t\t: keysSet;\n\t}\n\n\tgetSymbolsKeyValue() {\n\t\tif (this.state.showSymbols) {\n\t\t\treturn this.props.layouts[this.state.currentLayout].symbolsKeyValue;\n\t\t}\n\t\treturn SymbolsLayout.symbolsKeyValue;\n\t}\n\n\trender() {\n\t\tconst backSpace = this.props.backSpace ? this.props.backSpace : <BackspaceIcon />; \n\t\tconst shift = this.props.shift ? this.props.shift : <ShiftIcon />; \n\t\tconst {leftButtons, rightButtons, inputNode, space} = this.props;\n\t\tconst keys = this.getKeys();\n\t\tconst numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0];\n\t\tconst symbolsKeyValue = this.getSymbolsKeyValue();\n\n\t\treturn (\n\t\t\t<div className=\"keyboard\">\n\t\t\t\t<div className=\"keyboard-row\">\n\t\t\t\t\t{numbers.map(button =>\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={button}\n\t\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t\t\tclasses={'keyboard-numberButton'}\n\t\t\t\t\t\t\tkey={button}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\tvalue={backSpace}\n\t\t\t\t\t\tonClick={this.handleBackspaceClick}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"keyboard-row\">\n\t\t\t\t\t{keys[0].map(button =>\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={button}\n\t\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t\t\tkey={button}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"keyboard-row\">\n\t\t\t\t\t<div className=\"keyboard-halfButton\" />\n\t\t\t\t\t{keys[1].map(button =>\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={button}\n\t\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t\t\tkey={button}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className=\"keyboard-halfButton\" />\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"keyboard-row\">\n\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\tvalue={shift}\n\t\t\t\t\t\tonClick={this.handleShiftClick}\n\t\t\t\t\t/>\n\t\t\t\t\t{keys[2].map(button =>\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={button}\n\t\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t\t\tkey={button}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\tvalue={symbolsKeyValue}\n\t\t\t\t\t\tonClick={this.handleSymbolsClick}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"keyboard-row\">\n\t\t\t\t\t{leftButtons}\n\t\t\t\t\t{this.props.layouts.length > 1 ?\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={<LanguageIcon />}\n\t\t\t\t\t\t\tonClick={this.handleLanguageClick}\n\t\t\t\t\t\t/>\n\t\t\t\t\t: null}\n\t\t\t\t\t{inputNode.dataset.type === 'email' || inputNode.type === 'email' ?\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={'@'}\n\t\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t\t/>\n\t\t\t\t\t: null}\n\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\tvalue={space}\n\t\t\t\t\t\tclasses=\"keyboard-space\"\n\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t/>\n\t\t\t\t\t{inputNode.dataset.type === 'email' || inputNode.type === 'email' ?\n\t\t\t\t\t\t<KeyboardButton\n\t\t\t\t\t\t\tvalue={'.'}\n\t\t\t\t\t\t\tonClick={this.handleLetterButtonClick}\n\t\t\t\t\t\t/>\n\t\t\t\t\t: null}\n\t\t\t\t\t{rightButtons}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n"]}